{% block content %}
<form action="" class="create-approach" method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {% if form.non_field_errors %}
    <div class="help is-danger">
        <i class="material-icons">error</i>
        {{ form.non_field_errors }}
    </div>
    {% endif %}

    <div class="fields">
        <div class="field is-two-thirds name">
            <p class="control has-icons-left">
                <input autofocus class="input{% if form.name.errors %} is-danger{% endif %}" id="id_name" name="name"
                    maxlength="100" placeholder="Convolutional Ensemble with Averaged Pooling" required type="text"
                    value="{% if approach %}{{ approach.name }}{% else %}{{request.POST.name}}{% endif %}">
                <span class="icon is-small is-left">
                    <i class="material-icons">label</i>
                </span>
            </p>
            {% if form.name.errors %}
            <div class="help is-danger">
                {{ form.name.errors }}
            </div>
            {% endif %}
        </div>

  <div class="field is-two-thirds description">
            <p class="control has-icons-left">
                <textarea class="input{% if form.description.errors %} is-danger{% endif %}" id="id_description" name="description"
                     placeholder="" required>{% if approach %}{{ approach.description }}{% else %}{{request.POST.description}}{% endif %}</textarea>
                <span class="icon is-small is-left">
                    <i class="material-icons">label</i>
                </span>
            </p>
            {% if form.description.errors %}
            <div class="help is-danger">
                {{ form.description.errors }}
            </div>
            {% endif %}
        </div>

        <div class="field external-data">
            <div class="control">
                <label class="checkbox">
                    <input id="id_uses_external_data"
                        {% if request.POST.uses_external_data or approach.uses_external_data %}checked
                        {% endif %} name="uses_external_data" type="checkbox">
                    <p>Uses external data</p>
                </label>
            </div>
        </div>

        <div class="field file-upload">
            <div
                class="file has-name is-medium is-fullwidth is-right{% if form.manuscript.errors %} is-danger{% endif %}">
                <label class="file-label">
                    <input class="file-input" id="id_manuscript" name="manuscript"
                        {% if form.manuscript.required %}required{% endif %} type="file">
                    <span class="file-cta">
                        <span class="file-icon">
                            <i class="material-icons">file_copy</i>
                        </span>
                        <span class="file-label">
                            Choose a file (*.PDF)
                        </span>
                    </span>
                    <span class="file-name" id="file-name">
                        {% if approach.manuscript.name %}
                            {{ approach.manuscript.name }}
                        {% elif approach.manuscript %}
                            {{ approach.manuscript }}
                        {% else %}
                            No file chosen
                        {% endif %}
                    </span>
                </label>
                {% if form.manuscript.errors %}
                <div class="help is-danger">
                    {{ form.manuscript.errors }}
                </div>
                {% endif %}
            </div>
        </div>

        Optionally, you can submit your algorithm in the form of a Docker container to be used for ...

        For instructions on how to package your algorithm and publish it to Docker Hub, look at our example
        algorithm at https://github.com/ImageMarkup/isic-algorithm-example.
        <div class="field is-two-thirds docker-tag">
            <p class="control has-icons-left">
                <input autofocus class="input{% if form.docker_tag.errors %} is-danger{% endif %}" id="id_docker_tag" name="docker_tag"
                       maxlength="120" placeholder="isic/isic-algorithm-example:latest" type="text"
                       value="{% if approach %}{{ approach.docker_tag }}{% else %}{{request.POST.docker_tag}}{% endif %}">
                <span class="icon is-small is-left">
                    <i class="material-icons">label</i>
                </span>
            </p>
            {% if form.docker_tag.errors %}
                <div class="help is-danger">
                    {{ form.docker_tag.errors }}
                </div>
            {% endif %}
        </div>
    </div>

    <input type="hidden" name="next" value="{{ next }}" />
    <input id="create-approach-submit" class="button" type="submit" value="Submit" />
</form>

<script type="text/javascript">
    var file = document.getElementById("id_manuscript");
    file.onchange = function () {
        if (file.files.length > 0) {
            document.getElementById('file-name').innerHTML = file.files[0].name;
        }
    };
</script>
{% endblock %}
